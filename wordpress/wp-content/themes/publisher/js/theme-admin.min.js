var Publisher_Theme_Admin=function(t){"use strict";return{init:function(){this.blocks_switch(),this.attach_events(),this.mailchimp(),this.custom_width_field()},mailchimp:function(){t(document).on("change",".widget-mailchimp-code-field textarea",function(i,e){var a=t(this).val().match(/action="([^"]*?)"/i);void 0!=a&&void 0!==a[1]&&t(this).closest(".widget-mailchimp-code-field").siblings(".widget-mailchimp-url-field").find("input").val(a[1])}),t(document).on("change",'.wpb_el_type_textarea_raw_html textarea[name="mailchimp-code"]',function(){var i=t(this).val().match(/action="([^"]*?)"/i);void 0!=i&&void 0!==i[1]&&t(this).closest(".wpb_el_type_textarea_raw_html").siblings('div[data-vc-shortcode-param-name="mailchimp-url"]').find('textarea[name="mailchimp-url"]').val(i[1])})},attach_events:function(){var i=this;t(document).on("bf-ajax-tab-loaded",function(t,e){i.blocks_switch(e)})},blocks_switch:function(i){t(".blocks-field .blocks-switch span, .blocks-field .title",i).on("click",function(){var i=t(this),e=i.closest(".blocks-field").find(".blocks-switch"),a=e.find("input"),n=e.closest(".bf-controls"),l=n.find('.blocks-field[data-related-to="'+i.closest(".blocks-field").data("id")+'"]');e.hasClass("checked")?(e.removeClass("checked").addClass("unchecked"),a.attr("value",0),l.addClass("disabled")):(e.removeClass("unchecked").addClass("checked"),a.attr("value",1),l.removeClass("disabled"))})},custom_width_field:function(){function i(t){return t.element.closest(".resizable-width-container")}function e(t){return t%2&&t++,t}function a(i){var e=0;return i.each(function(){e+=t(this).data("width-prc")}),e}function n(e){var a=[e.element,e.element.next(".resizable-width-column")],n=i(e),l=t(".resizable-width-column",n),r=l;return a.forEach(function(t){l=l.not(t)}),[l,r.not(l)]}function l(e,l){var r=i(l),o=n(l),d=t(".resizable-width-section",r).outerWidth(),h=o[1],c=100-a(o[0]);h.filter(":not(:last)").each(function(){var i=t(this),e=Math.ceil(100*i.outerWidth()/d);i.data("width-prc",e).find(".resizable-width-labels-percentage").text(e+"%"),t("input.col-"+i.data("index")+"-width",r).val(e),c-=e}),c=Math.abs(c);var s=h.filter(":last");s.data("width-prc",c).find(".resizable-width-labels-percentage").text(c+"%"),t("input.col-"+s.data("index")+"-width",r).val(c)}function r(e,l){var r=i(l),o=n(l),d=o[1],h=t("input.total-width",r).val(),s=h-Math.ceil(a(o[0])/100*h);d.length||(d=t(".resizable-width-column",r),s=h),d.filter(":not(:last)").each(function(i){var e=t(this),a=e.data("width-prc"),n=Math.ceil(a/100*h);e.data("width-px",n).find(".resizable-width-labels-px").text(n+"px"),n<=c.columnMinWidth&&e.resizable("option","minWidth",e.outerWidth()),s-=n}),d.filter(":last").data("width-px",s).find(".resizable-width-labels-px").text(s+"px")}function o(e){var a=[e.element,e.element.next(".resizable-width-column")],n=i(e),l=t(".resizable-width-column",n);a.forEach(function(t){l=l.not(t)}),l.each(function(){var i=t(this),e=i.outerWidth();i.outerWidth(e).css({"min-width":e,"max-width":e})}),a.forEach(function(t){t.attr("style","")})}function d(t){return t.data("columns")||2}function h(e){var a=i(e),n=t(".resizable-width-columns-wrapper",a),l=t("input.total-width",a).val(),r=Math.max(2,d(n)-1)*c.borderSpacing,o=n.width(),h=Math.floor(c.columnMinWidth*o/l);e.originalElement.resizable("option","minWidth",h);var s=e.originalElement.next(".resizable-width-column").width()+e.originalElement.width()+r,u=s-h;e.originalElement.resizable("option","maxWidth",u)}var c={columnMinWidth:150,wrapper2ColumnMinWidth:600,wrapper3ColumnMinWidth:1e3,wrapperMaxWidth:1640,transformPxRatio:10,borderSpacing:4};!function(){t(".resizable-width-column").each(function(){var i=t(this),e=i.data("width-prc");e&&i.outerWidth(e+"%")})}(),t(".resizable-width-columns").each(function(){t(".resizable-width-column:not(:last)",this).resizable({handles:"e",minHeight:250,maxHeight:250,stop:function(i,e){var a=0,n=[];t(".resizable-width-column",e.element.parent()).each(function(){var i=t(this),e=i.outerWidth();a+=e,n.push([i,e])}).promise().done(function(){a/=100;for(var t=0;t<n.length;t++){var i=n[t][0];i.width(n[t][1]/a+"%")}})},resize:function(t,i){l(t,i),r(t,i)},start:function(t,i){h(i),o(i)}})}),t(".resizable-width-container").each(function(){function a(t){return(t-s)/(c.transformPxRatio/2)+h}var n=t(this),l=n.find(".resizable-width-columns-wrapper"),o=d(l),h=(2==o?44:70)*o,s=2==o?c.wrapper2ColumnMinWidth:c.wrapper3ColumnMinWidth,u=a(c.wrapperMaxWidth),m=a(l.data("total"));t(".resizable-width-total-wrapper",n).width(m),l.width(m),l.resizable({minHeight:280,maxHeight:280,handles:"e,w",minWidth:h,maxWidth:u,resize:function(a,n){if(!(n.size.width%2)){var l=i(n),o=s+(n.size.width-h)/2*c.transformPxRatio;o=e(o),t(".resizable-width-total-wrapper",l).outerWidth(n.size.width).css("left",n.position.left),t(".resizable-width-total-number",l).text(Math.ceil(o)+"px"),t("input.total-width",l).val(o),r(a,n)}},start:function(e,a){a.element.find(".resizable-width-column").css({"min-width":"","max-width":""});var n=i(a);t(".resizable-width-column",n).each(function(){var i=t(this),e=i.find(".resizable-width-labels-percentage").text();i.outerWidth(e)})}}).data("resize-options",{maxWidth:u})})}}}(jQuery);jQuery(document).ready(function(){Publisher_Theme_Admin.init()});